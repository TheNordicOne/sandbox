:host {
  /** Design token bridge (scoped to this component) */
  --sbc-rte-color-input-border: oklch(0.86 0.01 250);
  --sbc-rte-color-surface-0: oklch(1 0 0);
  --sbc-rte-color-surface-50: oklch(0.98 0.005 250);
  --sbc-rte-color-surface-100: oklch(0.96 0.007 250);
  --sbc-rte-color-surface-200: oklch(0.92 0.01 250);
  --sbc-rte-color-surface-300: oklch(0.88 0.012 250);
  --sbc-rte-color-text: oklch(0.2 0.02 250);
  --sbc-rte-color-gray-300: oklch(0.75 0.01 250);

  --sbc-rte-color-primary: oklch(0.56 0.16 251.3);
  --sbc-rte-color-primary-hover: oklch(0.52 0.16 251.3);
  --sbc-rte-color-primary-text: oklch(1 0 0);

  /** Editor field */
  --sbc-rte-editor-background: var(--sbc-rte-color-surface-0);
  --sbc-rte-editor-border-color: var(--sbc-rte-color-input-border);
  --sbc-rte-editor-text-color: var(--sbc-rte-color-text);

  /** Form control helpers used by the editor styles */
  --sbc-rte-check-color: var(--sbc-rte-color-primary);
  --sbc-rte-radio-indicator-size: 0.7em;
  --sbc-rte-form-control-color: oklch(0.2 0.02 250);

  /* Focus ring helpers */
  --sbc-rte-focus-ring-color: oklch(0.56 0.16 251.3 / 0.2);

  /** Range input */
  --sbc-rte-range-track-background: var(--sbc-rte-color-surface-200);
  --sbc-rte-range-track-active-background: var(--sbc-rte-color-primary);
  --sbc-rte-range-thumb-background: var(--sbc-rte-color-primary);
  --sbc-rte-range-thumb-border-color: var(--sbc-rte-color-primary);

  --sbc-rte-color-surface-b: oklch(0.97 0.006 250);
  --sbc-rte-color-surface-border: oklch(0.88 0.01 250);
  --sbc-rte-color-surface-hover: oklch(0.94 0.01 250);
  --sbc-rte-color-surface-d: oklch(0.92 0.01 250);
  --sbc-rte-color-surface-600: oklch(0.45 0.02 250);
  --sbc-rte-color-surface-700: oklch(0.35 0.02 250);

  /* Popover tokens (also used by the cell-color popover) */
  --sbc-rte-color-popover-border: oklch(0.88 0.01 250);
  --sbc-rte-shadow-popover: 0 10px 30px oklch(0 0 0 / 0.18);
}

// These styles could just be globally scoped to also align with other inputs
::ng-deep .sbc-input {
  &[type="text"],
  &[type="number"],
  &[type="date"],
  &.rich-text-editor {
    --sbc-rte-editor-border-color: var(--sbc-rte-color-input-border);
    --sbc-rte-editor-background: var(--sbc-rte-color-surface-0);
    --sbc-rte-editor-text-color: var(--sbc-rte-color-text);

    font-size: 1rem;
    color: var(--sbc-rte-editor-text-color);
    background: var(--sbc-rte-editor-background);
    padding: 0.5rem 0.5rem;
    border: 1px solid var(--sbc-rte-editor-border-color);
    transition: background-color 0.2s, color 0.2s, border-color 0.2s,
      box-shadow 0.2s;
    appearance: none;
    border-radius: 2px;
    outline-color: transparent;

    &:enabled:focus,
    &.rich-text-editor:focus {
      --sbc-rte-editor-border-color: var(--sbc-rte-color-primary);
      box-shadow: inset 0 0 0 1px var(--sbc-rte-color-primary);
      outline: 0 none;
      outline-offset: 0;
    }

    &:disabled {
      --sbc-rte-editor-background: var(--sbc-rte-color-surface-50);
      --sbc-rte-editor-border-color: var(--sbc-rte-color-surface-50);
      --sbc-rte-editor-text-color: var(--sbc-rte-color-gray-300);
      opacity: 1;
      user-select: none;
    }
  }

  &.rich-text-editor {
    border-block-start: none;
    border-top-left-radius: 0;
    border-top-right-radius: 0;
  }

  &[type="checkbox"],
  &[type="radio"] {
    --sbc-rte-editor-border-color: var(--sbc-rte-color-input-border);
    --sbc-rte-editor-background: var(--sbc-rte-color-surface-0);
    --sbc-rte-check-color: var(--sbc-rte-color-primary);

    appearance: none;
    width: 1.25rem;
    height: 1.25rem;
    border: 0.15em solid var(--sbc-rte-editor-border-color);
    background: var(--sbc-rte-editor-background);
    transition: background-color 0.2s, color 0.2s, border-color 0.2s,
      box-shadow 0.2s;
    cursor: pointer;
    outline-color: transparent;

    &:enabled:hover {
      --sbc-rte-editor-border-color: var(--sbc-rte-color-primary);
    }

    &:enabled:focus {
      --sbc-rte-editor-border-color: var(--sbc-rte-color-primary);
      box-shadow: 0 0 0 0.2rem var(--sbc-rte-focus-ring-color);
      outline: 0 none;
      outline-offset: 0;
    }

    &:checked {
      --sbc-rte-editor-border-color: var(--sbc-rte-check-color);
      --sbc-rte-editor-background: var(--sbc-rte-check-color);

      &::before {
        color: var(--sbc-rte-color-primary-text);
      }
    }

    &:disabled {
      --sbc-rte-editor-background: var(--sbc-rte-color-surface-50);
      --sbc-rte-editor-border-color: var(--sbc-rte-color-surface-200);
      opacity: 1;
      cursor: default;
    }

    &:disabled:checked {
      --sbc-rte-editor-background: var(--sbc-rte-color-surface-300);
    }
  }

  &[type="checkbox"] {
    border-radius: 2px;
    display: grid;
    place-items: center;

    &:checked::before {
      content: '';
      display: block;
      width: 0.375rem;
      height: 0.75rem;
      border: solid var(--sbc-rte-color-primary-text);
      border-width: 0 2px 2px 0;
      transform: rotate(45deg) translateY(-0.0625rem) translateX(-0.1rem);
    }
  }

  &[type="radio"] {
    border-radius: 50%;
    display: grid;
    place-content: center;

    &:checked {
      --sbc-rte-editor-border-color: var(--sbc-rte-check-color);
      --sbc-rte-editor-background: var(--sbc-rte-color-surface-0);
    }

    &::before {
      --sbc-rte-radio-indicator-size: 0.7em;
      content: '';
      width: var(--sbc-rte-radio-indicator-size);
      height: var(--sbc-rte-radio-indicator-size);
      transform: scale(0);
      background: var(--sbc-rte-check-color);
      border-radius: 50%;
      transition: 120ms transform ease-in-out;
      box-shadow: inset 1em 1em var(--sbc-rte-form-control-color);
    }

    &:checked::before {
      transform: scale(1);
    }
  }

  &[type="range"] {
    --sbc-rte-range-track-background: var(--sbc-rte-color-surface-200);
    --sbc-rte-range-track-active-background: var(--sbc-rte-color-primary);
    --sbc-rte-range-thumb-background: var(--sbc-rte-color-primary);
    --sbc-rte-range-thumb-border-color: var(--sbc-rte-color-primary);

    appearance: none;
    width: 100%;
    height: 0.375rem;
    background: var(--sbc-rte-range-track-background);
    border-radius: 2px;
    outline-color: transparent;
    cursor: pointer;

    &::-webkit-slider-thumb {
      appearance: none;
      width: 1.25rem;
      height: 1.25rem;
      background: var(--sbc-rte-range-thumb-background);
      border: 2px solid var(--sbc-rte-range-thumb-border-color);
      border-radius: 50%;
      cursor: pointer;
      transition: background-color 0.2s, border-color 0.2s, box-shadow 0.2s;
    }

    &::-moz-range-thumb {
      width: 1.25rem;
      height: 1.25rem;
      background: var(--sbc-rte-range-thumb-background);
      border: 2px solid var(--sbc-rte-range-thumb-border-color);
      border-radius: 50%;
      cursor: pointer;
      transition: background-color 0.2s, border-color 0.2s, box-shadow 0.2s;
    }

    &:enabled:hover {
      &::-webkit-slider-thumb {
        --sbc-rte-range-thumb-background: var(--sbc-rte-color-primary-hover);
        --sbc-rte-range-thumb-border-color: var(--sbc-rte-color-primary-hover);
      }

      &::-moz-range-thumb {
        --sbc-rte-range-thumb-background: var(--sbc-rte-color-primary-hover);
        --sbc-rte-range-thumb-border-color: var(--sbc-rte-color-primary-hover);
      }
    }

    &:enabled:focus {
      &::-webkit-slider-thumb {
        box-shadow: 0 0 0 0.2rem var(--sbc-rte-focus-ring-color);
        outline: 0 none;
      }

      &::-moz-range-thumb {
        box-shadow: 0 0 0 0.2rem var(--sbc-rte-focus-ring-color);
        outline: 0 none;
      }
    }

    &:disabled {
      --sbc-rte-range-track-background: var(--sbc-rte-color-surface-100);
      --sbc-rte-range-thumb-background: var(--sbc-rte-color-surface-300);
      --sbc-rte-range-thumb-border-color: var(--sbc-rte-color-surface-300);
      opacity: 1;
      cursor: default;
    }
  }

  &[type="file"] {
    --sbc-rte-editor-border-color: var(--sbc-rte-color-input-border);
    --sbc-rte-editor-background: var(--sbc-rte-color-surface-0);
    --sbc-rte-editor-text-color: var(--sbc-rte-color-text);

    font-size: 1rem;
    color: var(--sbc-rte-editor-text-color);
    background: var(--sbc-rte-editor-background);
    padding: 0.5rem;
    border: 1px solid var(--sbc-rte-editor-border-color);
    border-radius: 2px;
    transition: background-color 0.2s, color 0.2s, border-color 0.2s, box-shadow 0.2s;
    outline-color: transparent;
    cursor: pointer;

    &::file-selector-button {
      background: var(--sbc-rte-color-primary);
      color: var(--sbc-rte-color-primary-text);
      border: none;
      padding: 0.5rem 1rem;
      margin-right: 1rem;
      border-radius: 2px;
      cursor: pointer;
      transition: background-color 0.2s;
      font-size: 1rem;

      &:hover {
        background: var(--sbc-rte-color-primary-hover);
      }
    }

    &:enabled:focus {
      --sbc-rte-editor-border-color: var(--sbc-rte-color-primary);
      box-shadow: inset 0 0 0 1px var(--sbc-rte-color-primary);
      outline: 0 none;
      outline-offset: 0;
    }

    &:disabled {
      --sbc-rte-editor-background: var(--sbc-rte-color-surface-50);
      --sbc-rte-editor-border-color: var(--sbc-rte-color-surface-50);
      --sbc-rte-editor-text-color: var(--sbc-rte-color-gray-300);
      opacity: 1;
      cursor: default;

      &::file-selector-button {
        background: var(--sbc-rte-color-surface-200);
        color: var(--sbc-rte-color-gray-300);
        cursor: default;
      }
    }
  }

  &[type="image"] {
    --sbc-rte-editor-border-color: var(--sbc-rte-color-input-border);

    border: 1px solid var(--sbc-rte-editor-border-color);

    &:enabled:hover {
      --sbc-rte-editor-border-color: var(--sbc-rte-color-primary);
    }

    &:enabled:focus {
      --sbc-rte-editor-border-color: var(--sbc-rte-color-primary);
      box-shadow: 0 0 0 0.2rem var(--sbc-rte-focus-ring-color);
      outline: 0 none;
      outline-offset: 0;
    }

    &:disabled {
      --sbc-rte-editor-border-color: var(--sbc-rte-color-surface-200);
      opacity: 0.6;
      cursor: default;
    }
  }

  &[type="hidden"] {
    display: none;
  }
}


[data-readonly="true"] .rich-text-editor {
  border: none;
}

// Overrides for the UI only
// Any styles applied through css will not be saved to the editors value
.rich-text-editor  {
  p {
    margin: 0;
  }
}
